<!-- public/user.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Authentication</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="style.css">
  <script src="NAVBAR.JS" defer></script>
  <script src="footer.js" defer></script>

</head>
<body>
  <div id="navbar-container"></div>
  <section id="Registeration-form" class="section-p1">
    <form id="auth-form">
      <span>G&G</span>
      <h2>Authenticate Yourself</h2>
      <hr>
      <label for="User-ID">User-ID</label>
      <input type="text" id="User-ID" name="userId" placeholder="User-ID" required>
      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="Email" required>
      <label for="password">Password</label>
      <input type="password" id="password" name="password" placeholder="Password" required>
      <label for="Special-word">Special Word</label>
      <input type="text" id="Special-word" name="specialWord" placeholder="Special Word" required>
      <button class="normal" type="submit">Log In</button>
    </form>
  </section>
  
  <div id="footer-container"></div>
  
  <script>
    document.getElementById('auth-form').addEventListener('submit', async (event) => {
  event.preventDefault();

  const form = event.target;
  const formData = new FormData(form);

  const data = {
    userId: formData.get('userId'),
    email: formData.get('email'),
    password: formData.get('password'),
    specialWord: formData.get('specialWord'),
  };

  try {
    const response = await fetch('/adminAuth/authenticate', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });

    const result = await response.json();

    if (response.ok) {
      // Store token in localStorage
      localStorage.setItem('adminToken', result.token);

      // Redirect to admin panel
      window.location.href = 'admin_panel/index.html';
    } else {
      alert(result.message);
    }
  } catch (error) {
    console.error('Error during authentication:', error);
    alert('Authentication failed');
  }
});

  </script>
</body>
</html>
